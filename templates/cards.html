{% load static %}

<div class="center">
        <script>
            document.addEventListener("click", (e) => {
                if (!(e.target.id === "btn-report" || e.target.id === "btn-block" || e.target.id === "more-actions-btn")) {
                    document.querySelectorAll(".buttons").forEach(el => {el.classList.remove("visible")});
                }
            });
            const focus_actions = (e) => e.target.parentNode.querySelector('.buttons').classList.toggle('visible');
        </script>
    {% for user in users %}
        <section class="user-profile user-profile-short">
            <div id="more-actions">
                <button id="more-actions-btn" onclick="focus_actions(event)"></button>
                <span id="more-actions-span"></span>
                <div class="buttons">
                    <button id="btn-report">report user</button>
                    <button id="btn-block">block user</button>
                </div>
            </div>
            <figure>
                <div>
                    {% if user.photos %}
                        <img src="{{ user.photos.0.image }}" alt="default profile picture">
                    {% else %}
                        <img src="{% static 'img/default.png' %}" alt="default profile picture">
                    {% endif %}
                </div>
                <div class="not-here-pls" id="del-avatar" style="display: none;">
                    <span class="not-here-pls">&#10008;</span>
                </div>
                <div id="connection" class="{% if user.last_login != 'online' %}red{% endif %}">{{ user.last_login }}</div>
            </figure>
            <section class="user-data">
                <div id="username"><span>{{ user.username }}</span></div>
                <div id="name">
                    <span>{{ user.first_name }} {{ user.last_name }}</span>
                </div>
                <div id="rating">Рейтинг: <span>{{ user.rating }}&#9733;</span></div>
                <div>
                    {% if user.info %}
                        <button id="show-more">показать полностью</button>
                        <div id="history" class="short-history">Инфо: {{ user.info }}</div>
                    {% endif %}
                </div>
                {% if user.tags %}
                <section class="interests">
                    <div id="tags">
                        
                        <p class="white">Интересы: </p>
                        {% for tag in user.tags %}
                            <div class="tag">
                                <span>#{{ tag.tag }}</span>
                            </div>
                        {% endfor %}
                    </div>
                </section>
                {% endif %}
            </section>
            <section class="images">
                <div class="img-area">
                    <div>
                        <img id="output" style="display: none;">
                    </div>
                </div>
                <input type="file" id="imageInput" class="not-here-pls"name="imageInput" accept=".jpg, .jpeg, .png" onchange="image.loadFile(event)">
                <label style="display: none;" for="imageInput" class="not-here-pls" id="image-input">
                    <svg version="1.1" id="Capa_1" class="not-here-pls" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 477.863 477.863" style="enable-background:new 0 0 477.863 477.863;" xml:space="preserve"><g><g><path d="M409.598,153.596h-85.333c-9.426,0-17.067,7.641-17.067,17.067s7.641,17.067,17.067,17.067h85.333c9.426,0,17.067,7.641,17.067,17.067v221.867c0,9.426-7.641,17.067-17.067,17.067H68.265c-9.426,0-17.067-7.641-17.067-17.067V204.796c0-9.426,7.641-17.067,17.067-17.067h85.333c9.426,0,17.067-7.641,17.067-17.067s-7.641-17.067-17.067-17.067H68.265c-28.277,0-51.2,22.923-51.2,51.2v221.867c0,28.277,22.923,51.2,51.2,51.2h341.333c28.277,0,51.2-22.923,51.2-51.2V204.796C460.798,176.519,437.875,153.596,409.598,153.596z"/></g></g><g><g><path d="M336.331,90.33L250.998,4.997c-6.664-6.663-17.468-6.663-24.132,0L141.532,90.33c-6.548,6.78-6.36,17.584,0.42,24.132c6.614,6.388,17.099,6.388,23.713,0l56.201-56.201V341.33c0,9.426,7.641,17.067,17.067,17.067s17.067-7.641,17.067-17.067V58.262l56.201,56.201c6.78,6.548,17.584,6.36,24.132-0.42C342.719,107.429,342.719,96.944,336.331,90.33z"/></g></g></svg>
                </label>
            </section>
        </section>
    {% endfor %}
</div>
